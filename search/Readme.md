# Сервис Search

## Основное описание сервиса
Управляет атрибутами документов (автор, дата создания, категория). Реализует поисковой индекс для организации подборки подходящий файлов пользователю по различным критериям. Работает на своем порту, по пути /api/search

## Принцип работы

### Добавление записи
При загрузке файла программе необходимо создать запись в БД PostgreSQL, запрос производится на **http://localhost:api_port/api/search/metadata**:
```
{
    "id": "3f47a9e8-1d2c-4b5e-8f9a-1234567890ab_document.pdf",
    "originalName": "document.pdf",
    "author": "Иван Иванов",
    "category": "Контракты"
}
```
При успешном добавлении записи в БД, сервер возвращает следующий результат:
```
{
    "id": "3f47a9e8-1d2c-4b5e-8f9a-1234567890ab_document.pdf",
    "originalName": "document.pdf",
    "author": "Иван Иванов",
    "category": "Контракты",
    "createdAt": "2025-04-22T19:26:43.670977098Z",
    "fts": null
}
```
### Поиск записи по запросу
Если пользователь хочет найти файл по запросу, то программа отправляет запрос на **http://localhost:api_port/api/search?q={запрос}**, например (из примера выше) - http://localhost:api_port/api/search?q=контракты, результат:
```
[
    {
        "id": "3f47a9e8-1d2c-4b5e-8f9a-1234567890ab_document.pdf",
        "originalName": "document.pdf",
        "author": "Иван Иванов",
        "category": "Контракты",
        "createdAt": "2025-04-22T19:26:43.670977Z",
        "fts": "'document.pdf':1 'ива':2 'иван':3 'контракт':4"
    }
]
```

Или попробуем http://localhost:api_port/api/search?q=иванов, результат:
```
[
    {
        "id": "3f47a9e8-1d2c-4b5e-8f9a-1234567890ab_document.pdf",
        "originalName": "document.pdf",
        "author": "Иван Иванов",
        "category": "Контракты",
        "createdAt": "2025-04-22T19:26:43.670977Z",
        "fts": "'document.pdf':1 'ива':2 'иван':3 'контракт':4"
    }
]
```

В случае отсутствия результатов программа выводит пустой результат. 

## Базовая конфигурация
По умолчанию сервис развертывается на виртуальном порту 8085, физический порт 8082. Данные для доступа к БД должны быть идентичны как в основном docker-compose.yaml, так и в src/main/resources/application.yml.
Поддержка русского языка включена.